function startApp(){var e;let t=window.location.host,s=window.location.pathname,o=new FitAddon.FitAddon,n=new Terminal({screenKeys:!0,useStyle:!0,cursorBlink:!0,macOptionIsMeta:!0,scrollback:!0,fontFamily:"Source Code Pro"}),a=window.location.protocol.indexOf("https")?"ws":"wss",r=new WebSocket(`${a}://${t}${s}pty`);function i(){o.fit(),r.send(JSON.stringify({action:"resize",data:{cols:n.cols,rows:n.rows}}))}n.loadAddon(o);let d;window.onresize=(e=i,function(...t){let s=this;clearTimeout(d),d=setTimeout(()=>e.apply(s,t),50)}),r.onopen=function(){n.open(document.getElementById("webpty")),n.options.scrollback=5e3,i()},r.onmessage=function(e){n.write(e.data)},n.onKey(e=>{r.send(JSON.stringify({action:"input",data:{key:e.key}}))}),n.attachCustomKeyEventHandler(e=>{(e.ctrlKey||e.metaKey)&&"KeyV"===e.code&&"keydown"===e.type&&navigator.clipboard.readText().then(e=>{r.send(JSON.stringify({action:"input",data:{key:e}}))}),e.preventDefault()}),KEEP_ALIVE&&setInterval(function e(){r.send(JSON.stringify({action:"ping"}))},1e3*KEEP_ALIVE)}function getPasswordFromCookie(){let e=`; ${document.cookie}`,t=e.split("; webptyPass=");if(2===t.length)return t.pop().split(";").shift()}if(APP_SECURED){for(var userPassword=getPasswordFromCookie();null===userPassword||""===userPassword||void 0===userPassword;)if(userPassword=prompt("This is a password protected shell. Please enter your password.")){var e=new XMLHttpRequest;e.open("POST","/auth",!0),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify({webptyPass:userPassword})),e.onreadystatechange=function(){4==this.readyState&&(200!==this.status&&(userPassword=null),200===this.status&&location.reload())}}}startApp();